###
# FUNCTIONS
###

function(get_dir_list_by_include ROOT_DIR INCLUDE_DIRS RESULT_DIRS)
    file(GLOB INODES "${ROOT_DIR}/*")
    foreach(INODE ${INODES})
        if(IS_DIRECTORY ${INODE})
            get_filename_component(LEAF_NAME ${INODE} NAME)
            list(FIND INCLUDE_DIRS ${LEAF_NAME} INDEX)
            if(${INDEX} GREATER -1)
                list(APPEND RESULTS ${INODE})
            endif()
        endif()
    endforeach()
    set(${RESULT_DIRS} ${RESULTS} PARENT_SCOPE)
endfunction()

function(get_dir_list_by_exclude ROOT_DIR EXCLUDE_DIRS RESULT_DIRS)
    file(GLOB INODES "${ROOT_DIR}/*")
    foreach(INODE ${INODES})
        if(IS_DIRECTORY ${INODE})
            get_filename_component(LEAF_NAME ${INODE} NAME)
            list(FIND EXCLUDE_DIRS ${LEAF_NAME} INDEX)
            if(${INDEX} EQUAL -1)
                list(APPEND RESULTS ${INODE})
            endif()
        endif()
    endforeach()
    set(${RESULT_DIRS} ${RESULTS} PARENT_SCOPE)
endfunction()

function(get_inode_list ROOT_DIR INODE_PATTERN RESULT_INODES)
    file(GLOB RESULTS "${ROOT_DIR}/${INODE_PATTERN}")
    set(${RESULT_INODES} ${RESULTS} PARENT_SCOPE)
endfunction()

function(rget_inode_list ROOT_DIR FILE_PATTERN RESULT_FILES)
    file(GLOB_RECURSE RESULTS "${ROOT_DIR}/${FILE_PATTERN}")
    set(${RESULT_FILES} ${RESULTS} PARENT_SCOPE)
endfunction()

function(remove_inodes_from_list ROOT_DIR INODES EXCLUDE_DIR RESULT_FILES)
    get_dir_list_by_include(${ROOT_DIR} ${EXCLUDE_DIR} TARGET_DIR)
    rget_inode_list(${TARGET_DIR} "*" EXCLUDE_INODES)
    foreach(INODE ${EXCLUDE_INODES})
        list(REMOVE_ITEM INODES ${INODE})
    endforeach()
    set(${RESULT_FILES} ${INODES} PARENT_SCOPE)
endfunction()
